# Minimal Test Cases for Tramstops V2
# This file contains basic test cases using a toy workflow to test abstract tramline behavior
# The toy workflow is defined in toy-workflow.ts and provides a simple 4-state progression

test_cases:
  - name: 'Undefined status - no current status'
    description: 'When status is undefined, all critical path states should be shown as incomplete'
    current_status: null
    activities: []
    expected_tramline:
      - status: 'START'
        completed: false
        error: false
        warning: false
      - status: 'PROCESSING'
        completed: false
        error: false
        warning: false
      - status: 'APPROVED'
        completed: false
        error: false
        warning: false
      - status: 'COMPLETED'
        completed: false
        error: false
        warning: false

  - name: 'Initial state - no activities'
    description: 'When current status is START with no activities, only START should be completed'
    current_status: 'START'
    activities: []
    expected_tramline:
      - status: 'START'
        completed: true
        error: false
        warning: false
      - status: 'PROCESSING'
        completed: false
        error: false
        warning: false
      - status: 'APPROVED'
        completed: false
        error: false
        warning: false
      - status: 'COMPLETED'
        completed: false
        error: false
        warning: false

  - name: 'Initial state - with activities'
    description: 'When current status is START with activities, START should show completion date'
    current_status: 'START'
    activities:
      - status: 'START'
        date: '2024-01-10T10:00:00Z'
    expected_tramline:
      - status: 'START'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'PROCESSING'
        completed: false
        error: false
        warning: false
      - status: 'APPROVED'
        completed: false
        error: false
        warning: false
      - status: 'COMPLETED'
        completed: false
        error: false
        warning: false

  - name: 'Basic progression - PROCESSING'
    description: 'When current status is PROCESSING, both START and PROCESSING should be completed with dates'
    current_status: 'PROCESSING'
    activities:
      - status: 'START'
        date: '2024-01-10T10:00:00Z'
      - status: 'PROCESSING'
        date: '2024-01-15T14:30:00Z'
    expected_tramline:
      - status: 'START'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'PROCESSING'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-15T14:30:00Z'
      - status: 'APPROVED'
        completed: false
        error: false
        warning: false
      - status: 'COMPLETED'
        completed: false
        error: false
        warning: false

  - name: 'Error state replacement - FAILED with activity'
    description: 'When FAILED is current status with activity, it should replace PROCESSING and show as error'
    current_status: 'FAILED'
    activities:
      - status: 'START'
        date: '2024-01-10T10:00:00Z'
      - status: 'FAILED'
        date: '2024-01-15T14:30:00Z'
    expected_tramline:
      - status: 'START'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'FAILED'
        completed: true
        error: true
        warning: false
        subtitle: '2024-01-15T14:30:00Z'
      - status: 'APPROVED'
        completed: false
        error: false
        warning: false
      - status: 'COMPLETED'
        completed: false
        error: false
        warning: false

  - name: 'Error state replacement - FAILED without activity'
    description: 'When FAILED is current status without activity, it should still replace PROCESSING'
    current_status: 'FAILED'
    activities:
      - status: 'START'
        date: '2024-01-10T10:00:00Z'
    expected_tramline:
      - status: 'START'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'FAILED'
        completed: true
        error: true
        warning: false
      - status: 'APPROVED'
        completed: false
        error: false
        warning: false
      - status: 'COMPLETED'
        completed: false
        error: false
        warning: false

  - name: 'Error state replacement - FAILED with no activities'
    description: 'When FAILED is current status with no activities, it should still replace PROCESSING'
    current_status: 'FAILED'
    activities: []
    expected_tramline:
      - status: 'START'
        completed: true
        error: false
        warning: false
      - status: 'FAILED'
        completed: true
        error: true
        warning: false
      - status: 'APPROVED'
        completed: false
        error: false
        warning: false
      - status: 'COMPLETED'
        completed: false
        error: false
        warning: false

  - name: 'Unexpected failure insertion - UNEXPECTED_FAILURE'
    description: 'When UNEXPECTED_FAILURE is current status, it should be inserted after last completed state'
    current_status: 'UNEXPECTED_FAILURE'
    activities:
      - status: 'START'
        date: '2024-01-10T10:00:00Z'
    expected_tramline:
      - status: 'START'
        completed: true
        error: false
        warning: false
      - status: 'UNEXPECTED_FAILURE'
        completed: true
        error: true
        warning: false
      - status: 'PROCESSING'
        completed: false
        error: false
        warning: false
      - status: 'APPROVED'
        completed: false
        error: false
        warning: false
      - status: 'COMPLETED'
        completed: false
        error: false
        warning: false

  - name: 'Complete workflow - no activities'
    description: 'When COMPLETED is current status with no activities, all states should be completed'
    current_status: 'COMPLETED'
    activities: []
    expected_tramline:
      - status: 'START'
        completed: true
        error: false
        warning: false
      - status: 'PROCESSING'
        completed: true
        error: false
        warning: false
      - status: 'APPROVED'
        completed: true
        error: false
        warning: false
      - status: 'COMPLETED'
        completed: true
        error: false
        warning: false

  - name: 'Complete workflow - with activities'
    description: 'When COMPLETED is current status with activities, all states should show completion dates'
    current_status: 'COMPLETED'
    activities:
      - status: 'START'
        date: '2024-01-10T10:00:00Z'
      - status: 'PROCESSING'
        date: '2024-01-15T14:30:00Z'
      - status: 'APPROVED'
        date: '2024-01-20T09:15:00Z'
      - status: 'COMPLETED'
        date: '2024-01-25T16:45:00Z'
    expected_tramline:
      - status: 'START'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'PROCESSING'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-15T14:30:00Z'
      - status: 'APPROVED'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-20T09:15:00Z'
      - status: 'COMPLETED'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-25T16:45:00Z'

  - name: 'Warning handling - state tags only'
    description: 'Only states with warning tags should show warning flags (no activity warnings)'
    current_status: 'COMPLETED'
    activities:
      - status: 'START'
        date: '2024-01-10T10:00:00Z'
      - status: 'PROCESSING'
        date: '2024-01-15T14:30:00Z'
      - status: 'APPROVED'
        date: '2024-01-20T09:15:00Z'
      - status: 'COMPLETED'
        date: '2024-01-25T16:45:00Z'
    expected_tramline:
      - status: 'START'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'PROCESSING'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-15T14:30:00Z'
      - status: 'APPROVED'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-20T09:15:00Z'
      - status: 'COMPLETED'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-25T16:45:00Z'

  - name: 'Alternative state handling - FROM_CACHE'
    description: 'When FROM_CACHE appears in activities, it should replace PROCESSING in the tramline'
    current_status: 'COMPLETED'
    activities:
      - status: 'START'
        date: '2024-01-10T10:00:00Z'
      - status: 'FROM_CACHE'
        date: '2024-01-15T14:30:00Z'
      - status: 'APPROVED'
        date: '2024-01-20T09:15:00Z'
      - status: 'COMPLETED'
        date: '2024-01-25T16:45:00Z'
    expected_tramline:
      - status: 'START'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'FROM_CACHE'
        completed: true
        error: false
        warning: true
        subtitle: '2024-01-15T14:30:00Z'
      - status: 'APPROVED'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-20T09:15:00Z'
      - status: 'COMPLETED'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-25T16:45:00Z'

  - name: 'Alternative state as current - FROM_CACHE no activities'
    description: 'When FROM_CACHE is current status with no activities, it should replace PROCESSING and show warning'
    current_status: 'FROM_CACHE'
    activities: []
    expected_tramline:
      - status: 'START'
        completed: true
        error: false
        warning: false
      - status: 'FROM_CACHE'
        completed: true
        error: false
        warning: true
      - status: 'APPROVED'
        completed: false
        error: false
        warning: false
      - status: 'COMPLETED'
        completed: false
        error: false
        warning: false

  - name: 'Alternative state as current - FROM_CACHE with activities'
    description: 'When FROM_CACHE is current status with activities, it should show completion date and warnings'
    current_status: 'FROM_CACHE'
    activities:
      - status: 'START'
        date: '2024-01-10T10:00:00Z'
      - status: 'FROM_CACHE'
        date: '2024-01-15T14:30:00Z'
    expected_tramline:
      - status: 'START'
        completed: true
        error: false
        warning: false
      - status: 'FROM_CACHE'
        completed: true
        error: false
        warning: true
      - status: 'APPROVED'
        completed: false
        error: false
        warning: false
      - status: 'COMPLETED'
        completed: false
        error: false
        warning: false

  - name: 'Alternative error state as current - REJECTED no activities'
    description: 'When REJECTED is current status with no activities, it should replace APPROVED and show as error'
    current_status: 'REJECTED'
    activities: []
    expected_tramline:
      - status: 'START'
        completed: true
        error: false
        warning: false
      - status: 'PROCESSING'
        completed: true
        error: false
        warning: false
      - status: 'REJECTED'
        completed: true
        error: true
        warning: false
      - status: 'COMPLETED'
        completed: false
        error: false
        warning: false

  - name: 'Activity filtering - contradictory activities'
    description: 'When activities contain contradictions (PROCESSING and FROM_CACHE), only valid activities should be used'
    current_status: 'PROCESSING'
    activities:
      - status: 'START'
        date: '2024-01-10T10:00:00Z'
      - status: 'PROCESSING'
        date: '2024-01-15T14:30:00Z'
      - status: 'FROM_CACHE'
        date: '2024-01-15T14:30:00Z'
      - status: 'APPROVED'
        date: '2024-01-20T09:15:00Z'
      - status: 'COMPLETED'
        date: '2024-01-25T16:45:00Z'
    expected_tramline:
      - status: 'START'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'PROCESSING'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-15T14:30:00Z'
      - status: 'APPROVED'
        completed: false
        error: false
        warning: false
      - status: 'COMPLETED'
        completed: false
        error: false
        warning: false

  - name: 'Activity filtering - error state with contradictions'
    description: 'When REJECTED is current status with contradictory activities, only valid activities should be used'
    current_status: 'REJECTED'
    activities:
      - status: 'START'
        date: '2024-01-10T10:00:00Z'
      - status: 'PROCESSING'
        date: '2024-01-15T14:30:00Z'
      - status: 'FROM_CACHE'
        date: '2024-01-15T14:30:00Z'
      - status: 'REJECTED'
        date: '2024-01-20T09:15:00Z'
      - status: 'COMPLETED'
        date: '2024-01-25T16:45:00Z'
    expected_tramline:
      - status: 'START'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'PROCESSING'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-15T14:30:00Z'
      - status: 'REJECTED'
        completed: true
        error: true
        warning: false
        subtitle: '2024-01-20T09:15:00Z'
      - status: 'COMPLETED'
        completed: false
        error: false
        warning: false

  - name: 'Activity filtering - unexpected failure with contradictions'
    description: 'When UNEXPECTED_FAILURE is current status with contradictory activities, only valid activities should be used'
    current_status: 'UNEXPECTED_FAILURE'
    activities:
      - status: 'START'
        date: '2024-01-10T10:00:00Z'
      - status: 'PROCESSING'
        date: '2024-01-15T14:30:00Z'
      - status: 'FROM_CACHE'
        date: '2024-01-15T14:30:00Z'
    expected_tramline:
      - status: 'START'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'PROCESSING'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-15T14:30:00Z'
      - status: 'UNEXPECTED_FAILURE'
        completed: true
        error: true
        warning: false
      - status: 'APPROVED'
        completed: false
        error: false
        warning: false
      - status: 'COMPLETED'
        completed: false
        error: false
        warning: false

  - name: 'Non-error end state insertion - REQUEST_NEW_VERSION after START'
    description: 'When REQUEST_NEW_VERSION is current status with only START activity, it should be inserted after START'
    current_status: 'REQUEST_NEW_VERSION'
    activities:
      - status: 'START'
        date: '2024-01-10T10:00:00Z'
    expected_tramline:
      - status: 'START'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'REQUEST_NEW_VERSION'
        completed: true
        error: false
        warning: true
      - status: 'PROCESSING'
        completed: false
        error: false
        warning: false
      - status: 'APPROVED'
        completed: false
        error: false
        warning: false
      - status: 'COMPLETED'
        completed: false
        error: false
        warning: false

  - name: 'Non-error end state insertion - REQUEST_NEW_VERSION after PROCESSING'
    description: 'When REQUEST_NEW_VERSION is current status with START and PROCESSING activities, it should be inserted after PROCESSING'
    current_status: 'REQUEST_NEW_VERSION'
    activities:
      - status: 'START'
        date: '2024-01-10T10:00:00Z'
      - status: 'PROCESSING'
        date: '2024-01-15T14:30:00Z'
    expected_tramline:
      - status: 'START'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'PROCESSING'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-15T14:30:00Z'
      - status: 'REQUEST_NEW_VERSION'
        completed: true
        error: false
        warning: true
      - status: 'APPROVED'
        completed: false
        error: false
        warning: false
      - status: 'COMPLETED'
        completed: false
        error: false
        warning: false

  - name: 'Non-error end state insertion - REQUEST_NEW_VERSION with activity'
    description: 'When REQUEST_NEW_VERSION is current status with its own activity, it should show the activity date and warnings'
    current_status: 'REQUEST_NEW_VERSION'
    activities:
      - status: 'START'
        date: '2024-01-10T10:00:00Z'
      - status: 'PROCESSING'
        date: '2024-01-15T14:30:00Z'
      - status: 'REQUEST_NEW_VERSION'
        date: '2024-01-20T09:15:00Z'
    expected_tramline:
      - status: 'START'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'PROCESSING'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-15T14:30:00Z'
      - status: 'REQUEST_NEW_VERSION'
        completed: true
        error: false
        warning: true
        subtitle: '2024-01-20T09:15:00Z'
      - status: 'APPROVED'
        completed: false
        error: false
        warning: false
      - status: 'COMPLETED'
        completed: false
        error: false
        warning: false
