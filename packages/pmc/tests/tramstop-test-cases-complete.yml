# Complete Test Cases for Tramstops V2
# This file contains comprehensive test cases using the real PMC_DEPOSIT_WORKFLOW
# The workflow is defined in workflows.ts and provides the full PMC workflow

test_cases:
  # Basic States
  - name: 'Undefined status - no current status'
    description: 'When status is undefined, all critical path states should be shown as incomplete'
    current_status: null
    activities: []
    expected_tramline:
      - status: 'PENDING'
        completed: false
        error: false
        warning: false
      - status: 'DEPOSITED'
        completed: false
        error: false
        warning: false
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: false
        error: false
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  - name: 'Initial state - PENDING no activities'
    description: 'When current status is PENDING with no activities, only PENDING should be completed'
    current_status: 'PENDING'
    activities: []
    expected_tramline:
      - status: 'PENDING'
        completed: true
        error: false
        warning: false
      - status: 'DEPOSITED'
        completed: false
        error: false
        warning: false
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: false
        error: false
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  - name: 'Initial state - PENDING with activities'
    description: 'When current status is PENDING with activities, PENDING should show completion date'
    current_status: 'PENDING'
    activities:
      - status: 'PENDING'
        date: '2024-01-10T10:00:00Z'
    expected_tramline:
      - status: 'PENDING'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'DEPOSITED'
        completed: false
        error: false
        warning: false
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: false
        error: false
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  - name: 'Basic progression - DEPOSITED'
    description: 'When current status is DEPOSITED, both PENDING and DEPOSITED should be completed with dates'
    current_status: 'DEPOSITED'
    activities:
      - status: 'PENDING'
        date: '2024-01-10T10:00:00Z'
      - status: 'DEPOSITED'
        date: '2024-01-15T14:30:00Z'
    expected_tramline:
      - status: 'PENDING'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'DEPOSITED'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-15T14:30:00Z'
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: false
        error: false
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  # Error State Replacement Tests
  - name: 'Error state replacement - DEPOSIT_FAILED with activity'
    description: 'When DEPOSIT_FAILED is current status with activity, it should replace DEPOSITED and show as error'
    current_status: 'DEPOSIT_FAILED'
    activities:
      - status: 'PENDING'
        date: '2024-01-10T10:00:00Z'
      - status: 'DEPOSIT_FAILED'
        date: '2024-01-15T14:30:00Z'
    expected_tramline:
      - status: 'PENDING'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'DEPOSIT_FAILED'
        completed: true
        error: true
        warning: false
        subtitle: '2024-01-15T14:30:00Z'
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: false
        error: false
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  - name: 'Error state replacement - DEPOSIT_REJECTED_BY_PMC with activity'
    description: 'When DEPOSIT_REJECTED_BY_PMC is current status with activity, it should replace DEPOSIT_CONFIRMED_BY_PMC and show as error'
    current_status: 'DEPOSIT_REJECTED_BY_PMC'
    activities:
      - status: 'PENDING'
        date: '2024-01-10T10:00:00Z'
      - status: 'DEPOSITED'
        date: '2024-01-15T14:30:00Z'
      - status: 'DEPOSIT_REJECTED_BY_PMC'
        date: '2024-01-20T09:15:00Z'
    expected_tramline:
      - status: 'PENDING'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'DEPOSITED'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-15T14:30:00Z'
      - status: 'DEPOSIT_REJECTED_BY_PMC'
        completed: true
        error: true
        warning: false
        subtitle: '2024-01-20T09:15:00Z'
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: false
        error: false
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  - name: 'Error state replacement - REVIEWER_REJECTED_INITIAL with activity'
    description: 'When REVIEWER_REJECTED_INITIAL is current status with activity, it should replace REVIEWER_APPROVED_INITIAL and show as error'
    current_status: 'REVIEWER_REJECTED_INITIAL'
    activities:
      - status: 'PENDING'
        date: '2024-01-10T10:00:00Z'
      - status: 'DEPOSITED'
        date: '2024-01-15T14:30:00Z'
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        date: '2024-01-20T09:15:00Z'
      - status: 'REVIEWER_REJECTED_INITIAL'
        date: '2024-01-25T11:45:00Z'
    expected_tramline:
      - status: 'PENDING'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'DEPOSITED'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-15T14:30:00Z'
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-20T09:15:00Z'
      - status: 'REVIEWER_REJECTED_INITIAL'
        completed: true
        error: true
        warning: false
        subtitle: '2024-01-25T11:45:00Z'
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  - name: 'Error state replacement - DEPOSIT_FAILED without activities'
    description: 'When DEPOSIT_FAILED is current status with no activities, it should still replace DEPOSITED'
    current_status: 'DEPOSIT_FAILED'
    activities: []
    expected_tramline:
      - status: 'PENDING'
        completed: true
        error: false
        warning: false
      - status: 'DEPOSIT_FAILED'
        completed: true
        error: true
        warning: false
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: false
        error: false
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  - name: 'Error state replacement - DEPOSIT_REJECTED_BY_PMC without activities'
    description: 'When DEPOSIT_REJECTED_BY_PMC is current status with no activities, it should still replace DEPOSIT_CONFIRMED_BY_PMC'
    current_status: 'DEPOSIT_REJECTED_BY_PMC'
    activities: []
    expected_tramline:
      - status: 'PENDING'
        completed: true
        error: false
        warning: false
      - status: 'DEPOSITED'
        completed: true
        error: false
        warning: false
      - status: 'DEPOSIT_REJECTED_BY_PMC'
        completed: true
        error: true
        warning: false
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: false
        error: false
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  - name: 'Error state replacement - REVIEWER_REJECTED_INITIAL without activities'
    description: 'When REVIEWER_REJECTED_INITIAL is current status with no activities, it should still replace REVIEWER_APPROVED_INITIAL'
    current_status: 'REVIEWER_REJECTED_INITIAL'
    activities: []
    expected_tramline:
      - status: 'PENDING'
        completed: true
        error: false
        warning: false
      - status: 'DEPOSITED'
        completed: true
        error: false
        warning: false
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: true
        error: false
        warning: false
      - status: 'REVIEWER_REJECTED_INITIAL'
        completed: true
        error: true
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  # Alternative State Handling Tests
  - name: 'Alternative state handling - NO_ACTION_NEEDED'
    description: 'When NO_ACTION_NEEDED is current status with activity, it should replace DEPOSITED and show as end state'
    current_status: 'NO_ACTION_NEEDED'
    activities:
      - status: 'PENDING'
        date: '2024-01-10T10:00:00Z'
      - status: 'NO_ACTION_NEEDED'
        date: '2024-01-15T14:30:00Z'
    expected_tramline:
      - status: 'PENDING'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'NO_ACTION_NEEDED'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-15T14:30:00Z'
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: false
        error: false
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  - name: 'Alternative state handling - DEPOSIT_REJECTED_BY_PMC as alternative'
    description: 'When DEPOSIT_REJECTED_BY_PMC appears in activities, it should replace DEPOSIT_CONFIRMED_BY_PMC in the tramline'
    current_status: 'DEPOSIT_CONFIRMED_BY_PMC'
    activities:
      - status: 'PENDING'
        date: '2024-01-10T10:00:00Z'
      - status: 'DEPOSITED'
        date: '2024-01-15T14:30:00Z'
      - status: 'DEPOSIT_REJECTED_BY_PMC'
        date: '2024-01-20T09:15:00Z'
    expected_tramline:
      - status: 'PENDING'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'DEPOSITED'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-15T14:30:00Z'
      - status: 'DEPOSIT_REJECTED_BY_PMC'
        completed: true
        error: true
        warning: false
        subtitle: '2024-01-20T09:15:00Z'
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: false
        error: false
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  - name: 'Alternative state handling - NO_ACTION_NEEDED without activities'
    description: 'When NO_ACTION_NEEDED is current status with no activities, it should still replace DEPOSITED'
    current_status: 'NO_ACTION_NEEDED'
    activities: []
    expected_tramline:
      - status: 'PENDING'
        completed: true
        error: false
        warning: false
      - status: 'NO_ACTION_NEEDED'
        completed: true
        error: false
        warning: false
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: false
        error: false
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  - name: 'Alternative state handling - REVIEWER_REJECTED_INITIAL as current without activities'
    description: 'When REVIEWER_REJECTED_INITIAL is current status with no activities, it replaces REVIEWER_APPROVED_INITIAL'
    current_status: 'REVIEWER_REJECTED_INITIAL'
    activities: []
    expected_tramline:
      - status: 'PENDING'
        completed: true
        error: false
        warning: false
      - status: 'DEPOSITED'
        completed: true
        error: false
        warning: false
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: true
        error: false
        warning: false
      - status: 'REVIEWER_REJECTED_INITIAL'
        completed: true
        error: true
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  # Unexpected Failure Insertion Tests
  - name: 'Unexpected failure insertion - FAILED after partial progress'
    description: 'When FAILED is current status with partial activities, it should be inserted after last completed state'
    current_status: 'FAILED'
    activities:
      - status: 'PENDING'
        date: '2024-01-10T10:00:00Z'
      - status: 'DEPOSITED'
        date: '2024-01-15T14:30:00Z'
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        date: '2024-01-20T09:15:00Z'
    expected_tramline:
      - status: 'PENDING'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'DEPOSITED'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-15T14:30:00Z'
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-20T09:15:00Z'
      - status: 'FAILED'
        completed: true
        error: true
        warning: false
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: false
        error: false
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  - name: 'Unexpected failure insertion - CANCELLED early'
    description: 'When CANCELLED is current status with only PENDING activity, it should be inserted after PENDING'
    current_status: 'CANCELLED'
    activities:
      - status: 'PENDING'
        date: '2024-01-10T10:00:00Z'
    expected_tramline:
      - status: 'PENDING'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'CANCELLED'
        completed: true
        error: true
        warning: false
      - status: 'DEPOSITED'
        completed: false
        error: false
        warning: false
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: false
        error: false
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  - name: 'Unexpected failure insertion - REMOVED_FROM_PROCESSING with activity'
    description: 'When REMOVED_FROM_PROCESSING is current status with activity, it should show the activity date'
    current_status: 'REMOVED_FROM_PROCESSING'
    activities:
      - status: 'PENDING'
        date: '2024-01-10T10:00:00Z'
      - status: 'DEPOSITED'
        date: '2024-01-15T14:30:00Z'
      - status: 'REMOVED_FROM_PROCESSING'
        date: '2024-01-20T09:15:00Z'
    expected_tramline:
      - status: 'PENDING'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'DEPOSITED'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-15T14:30:00Z'
      - status: 'REMOVED_FROM_PROCESSING'
        completed: true
        error: true
        warning: false
        subtitle: '2024-01-20T09:15:00Z'
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: false
        error: false
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  - name: 'Unexpected failure insertion - FAILED without activities'
    description: 'When FAILED is current status with no activities, it should be inserted at the beginning'
    current_status: 'FAILED'
    activities: []
    expected_tramline:
      - status: 'FAILED'
        completed: true
        error: true
        warning: false
      - status: 'PENDING'
        completed: false
        error: false
        warning: false
      - status: 'DEPOSITED'
        completed: false
        error: false
        warning: false
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: false
        error: false
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  - name: 'Unexpected failure insertion - CANCELLED without activities'
    description: 'When CANCELLED is current status with no activities, it should be inserted at the beginning'
    current_status: 'CANCELLED'
    activities: []
    expected_tramline:
      - status: 'CANCELLED'
        completed: true
        error: true
        warning: false
      - status: 'PENDING'
        completed: false
        error: false
        warning: false
      - status: 'DEPOSITED'
        completed: false
        error: false
        warning: false
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: false
        error: false
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  - name: 'Unexpected failure insertion - REMOVED_FROM_PROCESSING without activities'
    description: 'When REMOVED_FROM_PROCESSING is current status with no activities, it should be inserted at the beginning'
    current_status: 'REMOVED_FROM_PROCESSING'
    activities: []
    expected_tramline:
      - status: 'REMOVED_FROM_PROCESSING'
        completed: true
        error: true
        warning: false
      - status: 'PENDING'
        completed: false
        error: false
        warning: false
      - status: 'DEPOSITED'
        completed: false
        error: false
        warning: false
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: false
        error: false
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  # Non-Error End State Insertion Tests
  - name: 'Non-error end state insertion - REQUEST_NEW_VERSION after PENDING'
    description: 'When REQUEST_NEW_VERSION is current status with only PENDING activity, it should be inserted after PENDING'
    current_status: 'REQUEST_NEW_VERSION'
    activities:
      - status: 'PENDING'
        date: '2024-01-10T10:00:00Z'
    expected_tramline:
      - status: 'PENDING'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'REQUEST_NEW_VERSION'
        completed: true
        error: false
        warning: true
      - status: 'DEPOSITED'
        completed: false
        error: false
        warning: false
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: false
        error: false
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  - name: 'Non-error end state insertion - REQUEST_NEW_VERSION with activity'
    description: 'When REQUEST_NEW_VERSION is current status with its own activity, it should show the activity date and warnings'
    current_status: 'REQUEST_NEW_VERSION'
    activities:
      - status: 'PENDING'
        date: '2024-01-10T10:00:00Z'
      - status: 'DEPOSITED'
        date: '2024-01-15T14:30:00Z'
      - status: 'REQUEST_NEW_VERSION'
        date: '2024-01-20T09:15:00Z'
    expected_tramline:
      - status: 'PENDING'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'DEPOSITED'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-15T14:30:00Z'
      - status: 'REQUEST_NEW_VERSION'
        completed: true
        error: false
        warning: true
        subtitle: '2024-01-20T09:15:00Z'
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: false
        error: false
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  - name: 'Non-error end state insertion - WITHDRAWN_FROM_PMC with activity'
    description: 'When WITHDRAWN_FROM_PMC is current status with activity, it should show warning status and activity data'
    current_status: 'WITHDRAWN_FROM_PMC'
    activities:
      - status: 'PENDING'
        date: '2024-01-10T10:00:00Z'
      - status: 'DEPOSITED'
        date: '2024-01-15T14:30:00Z'
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        date: '2024-01-20T09:15:00Z'
      - status: 'REVIEWER_APPROVED_INITIAL'
        date: '2024-01-25T11:45:00Z'
      - status: 'NIHMS_CONVERSION_COMPLETE'
        date: '2024-01-30T16:20:00Z'
      - status: 'REVIEWER_APPROVED_FINAL'
        date: '2024-02-05T13:10:00Z'
      - status: 'AVAILABLE_ON_PMC'
        date: '2024-02-10T09:30:00Z'
      - status: 'WITHDRAWN_FROM_PMC'
        date: '2024-02-15T14:45:00Z'
    expected_tramline:
      - status: 'PENDING'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'DEPOSITED'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-15T14:30:00Z'
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-20T09:15:00Z'
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-25T11:45:00Z'
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-30T16:20:00Z'
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: true
        error: false
        warning: false
        subtitle: '2024-02-05T13:10:00Z'
      - status: 'AVAILABLE_ON_PMC'
        completed: true
        error: false
        warning: false
        subtitle: '2024-02-10T09:30:00Z'
      - status: 'WITHDRAWN_FROM_PMC'
        completed: true
        error: false
        warning: true
        subtitle: '2024-02-15T14:45:00Z'

  - name: 'Non-error end state insertion - REQUEST_NEW_VERSION without activities'
    description: 'When REQUEST_NEW_VERSION is current status with no activities, it should be inserted at the beginning'
    current_status: 'REQUEST_NEW_VERSION'
    activities: []
    expected_tramline:
      - status: 'REQUEST_NEW_VERSION'
        completed: true
        error: false
        warning: true
      - status: 'PENDING'
        completed: false
        error: false
        warning: false
      - status: 'DEPOSITED'
        completed: false
        error: false
        warning: false
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: false
        error: false
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  # Complete Workflow Tests
  - name: 'Complete successful workflow - AVAILABLE_ON_PMC'
    description: 'When AVAILABLE_ON_PMC is current status with all activities, all states should show completion dates'
    current_status: 'AVAILABLE_ON_PMC'
    activities:
      - status: 'PENDING'
        date: '2024-01-10T10:00:00Z'
      - status: 'DEPOSITED'
        date: '2024-01-15T14:30:00Z'
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        date: '2024-01-20T09:15:00Z'
      - status: 'REVIEWER_APPROVED_INITIAL'
        date: '2024-01-25T11:45:00Z'
      - status: 'NIHMS_CONVERSION_COMPLETE'
        date: '2024-01-30T16:20:00Z'
      - status: 'REVIEWER_APPROVED_FINAL'
        date: '2024-02-05T13:10:00Z'
      - status: 'AVAILABLE_ON_PMC'
        date: '2024-02-10T09:30:00Z'
    expected_tramline:
      - status: 'PENDING'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'DEPOSITED'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-15T14:30:00Z'
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-20T09:15:00Z'
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-25T11:45:00Z'
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-30T16:20:00Z'
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: true
        error: false
        warning: false
        subtitle: '2024-02-05T13:10:00Z'
      - status: 'AVAILABLE_ON_PMC'
        completed: true
        error: false
        warning: false
        subtitle: '2024-02-10T09:30:00Z'

  # Activity Filtering Tests
  - name: 'Activity filtering - contradictory activities'
    description: 'When activities contain contradictions (DEPOSITED and NO_ACTION_NEEDED), only valid activities should be used'
    current_status: 'DEPOSITED'
    activities:
      - status: 'PENDING'
        date: '2024-01-10T10:00:00Z'
      - status: 'DEPOSITED'
        date: '2024-01-15T14:30:00Z'
      - status: 'NO_ACTION_NEEDED'
        date: '2024-01-15T14:30:00Z'
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        date: '2024-01-20T09:15:00Z'
    expected_tramline:
      - status: 'PENDING'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'DEPOSITED'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-15T14:30:00Z'
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: false
        error: false
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  - name: 'Activity filtering - current status dominance'
    description: 'When current status is DEPOSITED but activities include future states, future activities should be ignored'
    current_status: 'DEPOSITED'
    activities:
      - status: 'PENDING'
        date: '2024-01-10T10:00:00Z'
      - status: 'DEPOSITED'
        date: '2024-01-15T14:30:00Z'
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        date: '2024-01-20T09:15:00Z'
      - status: 'REVIEWER_APPROVED_INITIAL'
        date: '2024-01-25T11:45:00Z'
      - status: 'AVAILABLE_ON_PMC'
        date: '2024-02-10T09:30:00Z'
    expected_tramline:
      - status: 'PENDING'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'DEPOSITED'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-15T14:30:00Z'
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: false
        error: false
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  # Warning Handling Tests
  - name: 'Warning handling - activity warnings'
    description: 'When activities have warnings, tramline stops should show warning flags'
    current_status: 'DEPOSITED'
    activities:
      - status: 'PENDING'
        date: '2024-01-10T10:00:00Z'
      - status: 'DEPOSITED'
        date: '2024-01-15T14:30:00Z'
    expected_tramline:
      - status: 'PENDING'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'DEPOSITED'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-15T14:30:00Z'
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: false
        error: false
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  # Non-Error End State with Gapped Activities Tests
  - name: 'SUBMITTERS_FILES_REQUESTED with only PENDING activity'
    description: 'When SUBMITTERS_FILES_REQUESTED is current status with only PENDING activity, it should be inserted after PENDING'
    current_status: 'SUBMITTERS_FILES_REQUESTED'
    activities:
      - status: 'PENDING'
        date: '2024-01-10T10:00:00Z'
    expected_tramline:
      - status: 'PENDING'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'SUBMITTERS_FILES_REQUESTED'
        completed: true
        error: false
        warning: true
      - status: 'DEPOSITED'
        completed: false
        error: false
        warning: false
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: false
        error: false
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  - name: 'REQUEST_NEW_VERSION with only PENDING activity'
    description: 'When REQUEST_NEW_VERSION is current status with only PENDING activity, it should be inserted after PENDING (similar to existing test but explicit for this use case)'
    current_status: 'REQUEST_NEW_VERSION'
    activities:
      - status: 'PENDING'
        date: '2024-01-10T10:00:00Z'
    expected_tramline:
      - status: 'PENDING'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-10T10:00:00Z'
      - status: 'REQUEST_NEW_VERSION'
        completed: true
        error: false
        warning: true
      - status: 'DEPOSITED'
        completed: false
        error: false
        warning: false
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: false
        error: false
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  - name: 'SUBMITTERS_FILES_REQUESTED with gapped activities (DEPOSITED and DEPOSIT_CONFIRMED_BY_PMC)'
    description: 'When SUBMITTERS_FILES_REQUESTED is current status with DEPOSITED and DEPOSIT_CONFIRMED_BY_PMC activities (skipping PENDING), it should find the last actual activity and insert after it'
    current_status: 'SUBMITTERS_FILES_REQUESTED'
    activities:
      - status: 'DEPOSITED'
        date: '2024-01-15T14:30:00Z'
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        date: '2024-01-20T09:15:00Z'
    expected_tramline:
      - status: 'PENDING'
        completed: true
        error: false
        warning: false
      - status: 'DEPOSITED'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-15T14:30:00Z'
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-20T09:15:00Z'
      - status: 'SUBMITTERS_FILES_REQUESTED'
        completed: true
        error: false
        warning: true
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: false
        error: false
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false

  - name: 'REQUEST_NEW_VERSION with gapped activities (DEPOSITED and DEPOSIT_CONFIRMED_BY_PMC)'
    description: 'When REQUEST_NEW_VERSION is current status with DEPOSITED and DEPOSIT_CONFIRMED_BY_PMC activities (skipping PENDING), it should find the last actual activity and insert after it'
    current_status: 'REQUEST_NEW_VERSION'
    activities:
      - status: 'DEPOSITED'
        date: '2024-01-15T14:30:00Z'
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        date: '2024-01-20T09:15:00Z'
    expected_tramline:
      - status: 'PENDING'
        completed: true
        error: false
        warning: false
      - status: 'DEPOSITED'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-15T14:30:00Z'
      - status: 'DEPOSIT_CONFIRMED_BY_PMC'
        completed: true
        error: false
        warning: false
        subtitle: '2024-01-20T09:15:00Z'
      - status: 'REQUEST_NEW_VERSION'
        completed: true
        error: false
        warning: true
      - status: 'REVIEWER_APPROVED_INITIAL'
        completed: false
        error: false
        warning: false
      - status: 'NIHMS_CONVERSION_COMPLETE'
        completed: false
        error: false
        warning: false
      - status: 'REVIEWER_APPROVED_FINAL'
        completed: false
        error: false
        warning: false
      - status: 'AVAILABLE_ON_PMC'
        completed: false
        error: false
        warning: false
